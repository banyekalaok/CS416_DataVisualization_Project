<!DOCTYPE html>
<html>
<head>
  <title>Connecticut County Map and CT Bar Charts</title>
  <meta name="description" content="Interactive visualizations using D3.js: a map of Connecticut counties, a bar chart of Ohio's population from 2010 to 2022, a bar chart of Ohio's employment from 2010 to 2022, and a bar chart of Ohio's per capita income from 2010 to 2022.">
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <style>
    #map {
      background-image: url('ct-counties.jpg'); /* Use your image file here */
      background-size: cover;
      background-position: center;
      width: 800px;
      height: 600px;
    }
    path {
      fill: lightblue;
      stroke: black;
    }
    .button-container {
      text-align: center;
      margin-top: 20px;
    }
    .button-container button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
    }
    .bar {
      fill: steelblue;
    }
    .bar:hover {
      fill: darkblue;
    }
    .axis-label {
      font-size: 12px;
    }
    .hidden {
      display: none;
    }
    .dropdown-container {
      text-align: center;
      margin-top: 20px;
    }
    .chart {
      display: inline-block;
      width: 250px;
      height: 400px;
    }
    .chart-container {
      display: flex;
      justify-content: space-around;
    }
  </style>
</head>
<body>
  <h1>Connecticut County Map and CT Bar Charts</h1>
  <p>This page displays an interactive map of Connecticut counties, a bar chart of Ohio's population from 2010 to 2022, a bar chart of Ohio's employment from 2010 to 2022, and a bar chart of Ohio's per capita income from 2010 to 2022 using D3.js. Use the buttons below to switch between the visualizations.</p>

  <div id="map-container">
    <div id="map"></div>
  </div>

  <div class="dropdown-container hidden">
    <select id="county-dropdown">
      <option value="">Select a county</option>
      <!-- Dropdown options will be added here dynamically -->
    </select>
  </div>

  <div id="chart-container" class="hidden">
    <div class="chart-container">
      <svg id="population-chart" class="chart" width="250" height="400"></svg>
      <svg id="employment-chart" class="chart" width="250" height="400"></svg>
      <svg id="income-chart" class="chart" width="250" height="400"></svg>
    </div>
  </div>

  <div class="button-container">
    <button id="prev-button">Prev</button>
    <button id="next-button">Next</button>
  </div>

  <script>
    // Dummy data for counties (for dropdown functionality)
    var countyData = {
      "Fairfield": [300000, 305000, 310000, 315000, 320000, 325000, 330000, 335000, 340000, 345000, 350000, 355000, 360000],
      "Hartford": [250000, 255000, 260000, 265000, 270000, 275000, 280000, 285000, 290000, 295000, 300000, 305000, 310000],
      "Litchfield": [200000, 205000, 210000, 215000, 220000, 225000, 230000, 235000, 240000, 245000, 250000, 255000, 260000],
      "Middlesex": [150000, 155000, 160000, 165000, 170000, 175000, 180000, 185000, 190000, 195000, 200000, 205000, 210000],
      "New Haven": [350000, 355000, 360000, 365000, 370000, 375000, 380000, 385000, 390000, 395000, 400000, 405000, 410000],
      "New London": [175000, 180000, 185000, 190000, 195000, 200000, 205000, 210000, 215000, 220000, 225000, 230000, 235000],
      "Tolland": [125000, 130000, 135000, 140000, 145000, 150000, 155000, 160000, 165000, 170000, 175000, 180000, 185000],
      "Windham": [100000, 105000, 110000, 115000, 120000, 125000, 130000, 135000, 140000, 145000, 150000, 155000, 160000]
    };

    // Populate the dropdown menu with county names
    var dropdown = d3.select("#county-dropdown");
    for (var county in countyData) {
      dropdown.append("option")
              .attr("value", county)
              .text(county);
    }

    dropdown.on("change", function() {
      var selectedCounty = this.value;
      if (selectedCounty) {
        updateCountyCharts(selectedCounty);
      }
    });

    function updateCountyCharts(countyName) {
      var selectedData = countyData[countyName];
      
      updateChart("#population-chart", selectedData, "Population", [100000, 400000]);
      updateChart("#employment-chart", selectedData, "Employment", [100000, 400000]); // Example range
      updateChart("#income-chart", selectedData, "Per Capita Income", [10000, 50000]); // Example range
    }

    // General function to update any chart
    function updateChart(selector, data, label, yDomain) {
      var chartWidth = 250;
      var chartHeight = 400;
      var margin = {top: 30, right: 20, bottom: 50, left: 50};

      var svg = d3.select(selector)
                  .attr("width", chartWidth)
                  .attr("height", chartHeight);

      var x = d3.scaleBand()
                .domain(years)
                .range([margin.left, chartWidth - margin.right])
                .padding(0.1);

      var y = d3.scaleLinear()
                .domain(yDomain) 
                .nice()
                .range([chartHeight - margin.bottom, margin.top]);

      svg.selectAll(".x-axis").remove();
      svg.selectAll(".y-axis").remove();
      svg.selectAll(".bar").remove();

      svg.append("g")
         .attr("class", "x-axis")
         .attr("transform", `translate(0,${chartHeight - margin.bottom})`)
         .call(d3.axisBottom(x).tickSizeOuter(0))
         .append("text")
         .attr("class", "axis-label")
         .attr("x", chartWidth / 2)
         .attr("y", margin.bottom - 10)
         .attr("fill", "black")
         .attr("text-anchor", "middle")
         .text("Year");

      var yAxis = svg.append("g")
                     .attr("class", "y-axis")
                     .attr("transform", `translate(${margin.left},0)`)
                     .call(d3.axisLeft(y));

      yAxis.append("text")
           .attr("class", "axis-label")
           .attr("x", -margin.left)
           .attr("y", margin.top - 10)
           .attr("fill", "black")
           .attr("text-anchor", "start")
           .text(label);

      svg.selectAll(".bar")
         .data(data)
         .enter().append("rect")
         .attr("class", "bar")
         .attr("x", (d, i) => x(years[i]))
         .attr("y", d => y(d))
         .attr("width", x.bandwidth())
         .attr("height", d => y(0) - y(d));
    }

    var state = 0; // 0 for map, 1 for population chart, 2 for employment chart, 3 for income chart, 4 for county chart

    function updateVisualization() {
      if (state === 0) {
        document.getElementById('map-container').classList.remove('hidden');
        document.getElementById('chart-container').classList.add('hidden');
        document.querySelector('.dropdown-container').classList.add('hidden');
      } else if (state === 1) {
        document.getElementById('map-container').classList.add('hidden');
        document.getElementById('chart-container').classList.remove('hidden');
        document.querySelector('.dropdown-container').classList.add('hidden');
        updateChart("#population-chart", populationData, "Population", [3500000, 3700000]);
      } else if (state === 2) {
        document.getElementById('map-container').classList.add('hidden');
        document.getElementById('chart-container').classList.remove('hidden');
        document.querySelector('.dropdown-container').classList.add('hidden');
        updateChart("#employment-chart", employmentData, "Employment", [2100000, 2400000]);
      } else if (state === 3) {
        document.getElementById('map-container').classList.add('hidden');
        document.getElementById('chart-container').classList.remove('hidden');
        document.querySelector('.dropdown-container').classList.add('hidden');
        updateChart("#income-chart", incomeData, "Per Capita Income", [60000, 85000]);
      } else if (state === 4) {
        document.getElementById('map-container').classList.add('hidden');
        document.getElementById('chart-container').classList.remove('hidden');
        document.querySelector('.dropdown-container').classList.remove('hidden');
      }
    }

    // Button event listeners
    document.getElementById('prev-button').addEventListener('click', function() {
      state = (state - 1 + 5) % 5;
      updateVisualization();
    });

    document.getElementById('next-button').addEventListener('click', function() {
      state = (state + 1) % 5;
      updateVisualization();
    });

    // Initialize the visualization
    updateVisualization();
  </script>
</body>
</html>

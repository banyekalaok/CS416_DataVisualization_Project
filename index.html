<!DOCTYPE html>
<html>
<head>
  <title>Connecticut County Map and Connecticut Bar Charts</title>
  <meta name="description" content="Interactive visualizations using D3.js: a map of Connecticut counties, a bar chart of Connecticut's population from 2010 to 2022, a bar chart of Connecticut's employment from 2010 to 2022, and a bar chart of Connecticut's per capita income from 2010 to 2022.">
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <style>
    path {
      fill: lightblue;
      stroke: black;
    }
    .button-container {
      text-align: center;
      margin-top: 20px;
    }
    .button-container button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
    }
    .bar {
      fill: steelblue;
    }
    .bar:hover {
      fill: darkblue;
    }
    .axis-label {
      font-size: 12px;
    }
    .hidden {
      display: none;
    }
    .dropdown-container {
      text-align: center;
      margin-top: 20px;
    }
    .chart-container {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <h1>Connecticut County Map and Connecticut Bar Charts</h1>
  <p>This page displays an interactive map of Connecticut counties, and bar charts of Connecticut's population, employment, and per capita income from 2010 to 2022 using D3.js. Use the buttons below to switch between the visualizations.</p>

  <div id="map-container">
    <svg id="map" width="800" height="600"></svg>
  </div>

  <div class="dropdown-container hidden">
    <select id="county-dropdown">
      <option value="">Select a county</option>
      <option value="Fairfield, CT">Fairfield</option>
      <option value="Hartford, CT">Hartford</option>
      <option value="Litchfield, CT">Litchfield</option>
      <option value="Middlesex, CT">Middlesex</option>
      <option value="New Haven, CT">New Haven</option>
      <option value="New London, CT">New London</option>
      <option value="Tolland, CT">Tolland</option>
      <option value="Windham, CT">Windham</option>
    </select>
  </div>

  <div id="chart-container" class="hidden">
    <div class="chart-container" id="population-chart">
      <svg id="population-svg" width="800" height="400"></svg>
    </div>
    <div class="chart-container" id="income-chart">
      <svg id="income-svg" width="800" height="400"></svg>
    </div>
    <div class="chart-container" id="employment-chart">
      <svg id="employment-svg" width="800" height="400"></svg>
    </div>
  </div>

  <div class="button-container">
    <button id="prev-button">Prev</button>
    <button id="next-button">Next</button>
  </div>

  <script>
    // Constants for SVG dimensions
    var chartWidth = 800;
    var chartHeight = 400;
    var margin = {top: 30, right: 20, bottom: 50, left: 50};
    var years = [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022];
    
    // Datasets for Connecticut
    var populationData = [3580279, 3594193, 3605259, 3610314, 3614695, 3611995, 3607688, 3607615, 3611318, 3607159, 3597362, 3623355, 3626205];
    var employmentData = [2171940, 2206253, 2223243, 2246505, 2266061, 2288144, 2301331, 2300273, 2314465, 2297910, 2217432, 2289551, 2391946];
    var incomeData = [61392, 62964, 63555, 61999, 64482, 66220, 67550, 69146, 72157, 74173, 77383, 80691, 82938];
    
    // SVG containers
    var populationSvg = d3.select("#population-svg");
    var incomeSvg = d3.select("#income-svg");
    var employmentSvg = d3.select("#employment-svg");

    // Setup scales and axes
    function setupChart(svg, data, label, yDomain) {
      var x = d3.scaleBand()
                .domain(years)
                .range([margin.left, chartWidth - margin.right])
                .padding(0.1);

      var y = d3.scaleLinear()
                .domain(yDomain)
                .nice()
                .range([chartHeight - margin.bottom, margin.top]);

      svg.selectAll("*").remove();

      svg.append("g")
         .attr("class", "x-axis")
         .attr("transform", `translate(0,${chartHeight - margin.bottom})`)
         .call(d3.axisBottom(x).tickSizeOuter(0))
         .append("text")
         .attr("class", "axis-label")
         .attr("x", chartWidth / 2)
         .attr("y", margin.bottom - 10)
         .attr("fill", "black")
         .attr("text-anchor", "middle")
         .text("Year");

      var yAxis = svg.append("g")
                     .attr("class", "y-axis")
                     .attr("transform", `translate(${margin.left},0)`)
                     .call(d3.axisLeft(y));

      yAxis.append("text")
           .attr("class", "axis-label")
           .attr("x", -margin.left)
           .attr("y", margin.top - 10)
           .attr("fill", "black")
           .attr("text-anchor", "start")
           .text(label);

      svg.selectAll(".bar")
         .data(data)
         .enter().append("rect")
         .attr("class", "bar")
         .attr("x", (d, i) => x(years[i]))
         .attr("y", d => y(d))
         .attr("width", x.bandwidth())
         .attr("height", d => y(0) - y(d));
    }

    // Update charts for selected county
    function updateCountyCharts(countyName) {
      // Dummy data for counties
      var countyData = {
        "Fairfield, CT": {
          population: [919702, 929775, 938339, 944612, 950338, 952518, 953669, 954050, 956852, 957097, 955261, 963050, 962946],
          income: [102572, 102997, 101729, 95083, 99718, 101239, 103708, 106972, 112898, 113634, 115859, 119982, 125185],
          employment: [605634, 621729, 628393, 639197, 646565, 657037, 663787, 658198, 663335, 653822, 633880, 660242, 697773]
        },
        "Hartford, CT": {
          population: [895440, 898033, 899840, 900791, 901481, 901332, 899949, 899713, 900246, 899727, 896666, 898265, 898783],
          income: [50432, 52406, 53574, 53855, 55768, 57678, 58536, 59688, 61867, 63511, 66436, 69487, 70339],
          employment: [620140, 629924, 633093, 638818, 646397, 652539, 653785, 656110, 660969, 659664, 633784, 647256, 668935]
        },
        // Add data for other counties here - dummy
         "Litchfield, CT": {
          population: [919702, 929775, 938339, 944612, 950338, 952518, 953669, 954050, 956852, 957097, 955261, 963050, 962946],
          income: [102572, 102997, 101729, 95083, 99718, 101239, 103708, 106972, 112898, 113634, 115859, 119982, 125185],
          employment: [605634, 621729, 628393, 639197, 646565, 657037, 663787, 658198, 663335, 653822, 633880, 660242, 697773]
        },
        "Middlesex, CT": {
          population: [895440, 898033, 899840, 900791, 901481, 901332, 899949, 899713, 900246, 899727, 896666, 898265, 898783],
          income: [50432, 52406, 53574, 53855, 55768, 57678, 58536, 59688, 61867, 63511, 66436, 69487, 70339],
          employment: [620140, 629924, 633093, 638818, 646397, 652539, 653785, 656110, 660969, 659664, 633784, 647256, 668935]
        },
         "New Haven, CT": {
          population: [919702, 929775, 938339, 944612, 950338, 952518, 953669, 954050, 956852, 957097, 955261, 963050, 962946],
          income: [102572, 102997, 101729, 95083, 99718, 101239, 103708, 106972, 112898, 113634, 115859, 119982, 125185],
          employment: [605634, 621729, 628393, 639197, 646565, 657037, 663787, 658198, 663335, 653822, 633880, 660242, 697773]
        },
        "New London, CT": {
          population: [895440, 898033, 899840, 900791, 901481, 901332, 899949, 899713, 900246, 899727, 896666, 898265, 898783],
          income: [50432, 52406, 53574, 53855, 55768, 57678, 58536, 59688, 61867, 63511, 66436, 69487, 70339],
          employment: [620140, 629924, 633093, 638818, 646397, 652539, 653785, 656110, 660969, 659664, 633784, 647256, 668935]
        },
         "Tolland, CT": {
          population: [919702, 929775, 938339, 944612, 950338, 952518, 953669, 954050, 956852, 957097, 955261, 963050, 962946],
          income: [102572, 102997, 101729, 95083, 99718, 101239, 103708, 106972, 112898, 113634, 115859, 119982, 125185],
          employment: [605634, 621729, 628393, 639197, 646565, 657037, 663787, 658198, 663335, 653822, 633880, 660242, 697773]
        },
        "Windham, CT": {
          population: [895440, 898033, 899840, 900791, 901481, 901332, 899949, 899713, 900246, 899727, 896666, 898265, 898783],
          income: [50432, 52406, 53574, 53855, 55768, 57678, 58536, 59688, 61867, 63511, 66436, 69487, 70339],
          employment: [620140, 629924, 633093, 638818, 646397, 652539, 653785, 656110, 660969, 659664, 633784, 647256, 668935]
        }
      };

      var selectedData = countyData[countyName];
      if (selectedData) {
        setupChart(populationSvg, selectedData.population, countyName + " Population", [0, d3.max(selectedData.population)]);
        setupChart(incomeSvg, selectedData.income, countyName + " Per Capita Income", [0, d3.max(selectedData.income)]);
        setupChart(employmentSvg, selectedData.employment, countyName + " Employment", [0, d3.max(selectedData.employment)]);
      }
    }

    // Initial chart setup for example
    updateCountyCharts("Fairfield, CT");

    // Event listener for dropdown change
    d3.select("#county-dropdown").on("change", function() {
      var selectedCounty = d3.select(this).property("value");
      if (selectedCounty) {
        d3.select("#chart-container").classed("hidden", false);
        updateCountyCharts(selectedCounty);
      } else {
        d3.select("#chart-container").classed("hidden", true);
      }
    });

    // Next and Previous button functionality
    var currentIndex = 0;
    var counties = ["Fairfield, CT", "Hartford, CT", "Litchfield, CT", "Middlesex, CT", "New Haven, CT", "New London, CT", "Tolland, CT", "Windham, CT"];

    function updateCharts() {
      var county = counties[currentIndex];
      updateCountyCharts(county);
      d3.select("#county-dropdown").property("value", county);
    }

    d3.select("#next-button").on("click", function() {
      currentIndex = (currentIndex + 1) % counties.length;
      updateCharts();
    });

    d3.select("#prev-button").on("click", function() {
      currentIndex = (currentIndex - 1 + counties.length) % counties.length;
      updateCharts();
    });
  </script>
</body>
</html>
